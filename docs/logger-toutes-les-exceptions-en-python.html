<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <title>Logger toutes les exceptions en Python</title>
    <meta name="description" content="">
    <link rel="canonical" href="./logger-toutes-les-exceptions-en-python.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Alexis Couronne">
    <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Skitoo ATOM Feed" />
    <link href="./theme/css/style.css" rel="stylesheet">
    <link href="./theme/css/whhg.css" rel="stylesheet">
    <link href="./theme/css/monokai.css" rel="stylesheet">
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="shortcut icon" href="./theme/img/favicon.png">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="./theme/img/apple-touch-icon-144.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="./theme/img/apple-touch-icon-114.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="./theme/img/apple-touch-icon-72.png">
    <link rel="apple-touch-icon-precomposed" href="./theme/img/apple-touch-icon-57.png">
  </head>

  <body>
    <div class="container">
    <header id="header" class="header">
        <div class="header-content">
            <div class="logo">
                <a href="." title="Skitoo.net"><img src="./theme/img/logo-skitoo.png" alt="Alexis Couronne" width="140" height="44"></a>
            </div>
            <ul class="menu">
              <li><a href="./journal.html">journal</a></li>
              <li><a href="./projets.html">projets</a></li>
              <li><a href="./colophon.html">colophon</a></li>
            </ul>
        </div>
    </header>

    <div id="content" class="content">
        <div id="sidebar" class="sidebar">
        <div class="icon icon-python"></div>
        </div>
        <div id="main" class="main">
<article>
    <header>
        <h1>Logger toutes les exceptions en Python</h1>
        <span class="publication-date">
            <time datetime="2014-05">Mai 2014</time>, Alexis Couronne - 
            [
                <a href="tag/python.html">Python</a> ::                 <a href="tag/logging.html">Logging</a>            ]
        </span>
    </header>
    <div id="ticket-content" class="ticket-content">
        <p>Si comme moi vous travaillez sur des projets ayant une taille conséquante il peut être intéressant de logger l'ensemble des exceptions à l'aide du logger Python. Seulement mettre des try/except dans le moindre recoin de votre code peut rapidement être fastidieux et rend votre code vite illisible.</p>
<p>En python, comme dans d'autre langage de programmation, il existe un moyen simple de faire cela une fois pour toutes : dans notre cas, la fonction <a href="https://docs.python.org/2/library/sys.html#sys.excepthook">sys.excepthook</a></p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">traceback</span> <span class="kn">as</span> <span class="nn">tb</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">log_exception_hook</span><span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tb</span><span class="o">.</span><span class="n">format_tb</span><span class="p">(</span><span class="n">traceback</span><span class="p">)))</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;{0} - {1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>

<span class="n">sys</span><span class="o">.</span><span class="n">excepthook</span> <span class="o">=</span> <span class="n">log_exception_hook</span>
</pre></div>


<p>En cas d'exception la fonction <em>log_exception_hook</em> sera appelée. Le premier paramètre est la classe de l'exception, le second est l'objet exception et enfin le troisième le traceback que l'exception à produite.</p>
    </div>
    <hr class="hr">
    <div>
        <ul class="pagination">
                <li><a href="./tutoriel-arduino-comment-controler-un-servomoteur-avec-un-nunchuck-de-wii.html" rel="prev">&laquo; Précédent</a></li>
                <li><a href="./gestion-des-groupes-sous-linux.html" rel="next">Suivant &raquo;</a></li>
        </ul>
    </div>
    <footer>
      <p>Des appréciations, des remarques, des questions ? N'hésitez pas à <a href="mailto:contact@skitoo.net">me contacter</a>.</p>
        <p>Suivez moi sur <a href="https://twitter.com/skitoo/" title="Compte Twitter">Twitter</a> et sur <a href="https://github.com/skitoo/" title="Compte Github">Github</a>.</p>
    </footer>
</article>
        </div>
    </div>

    <footer id="footer" class="footer">
        <ul>
          <li><a href="mailto:contact@skitoo.net" title="Mail de Contact"><i class="icon-envelope"></i> Contact</a></li>
            <li><a href="/feeds/all.atom.xml" title="Flux RSS"><i class="icon-rss"></i> RSS</a></li>
            <li><a href="https://github.com/skitoo/" title="Compte Github"><i class="icon-github"></i> Github</a></li>
            <li><a href="https://twitter.com/skitoo/" title="Compte Twitter"><i class="icon-twitter"></i> Twitter</a></li>
            <li><a href="./journal.html"><i class="icon-book"></i> Journal</a></li>
            <li><a href="./projets.html"><i class="icon-flaskfull"></i> Projets</a></li>
            <li><a href="./colophon.html"><i class="icon-leaf"></i> Colophon</a></li>
        </ul>
        <p id="copyright" class="copyright">© 2018 Alexis Couronne</p>
    </footer>
    </div>
  </body>
</html>